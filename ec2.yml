---
AWSTemplateFormatVersion: "2010-09-09"
Transform: AWS::Serverless-2016-10-31

Parameters:
 InstanceType:
  Type: String
  Default: t2.micro
  Description: Enter Type Of Instance-

 InstanceName:
  Description: EC2 INSTANCE NAME
  Type: String

 BucketName:
  Description: S3 bucket Name
  Type: String

Resources:
  MyInstance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-05502a22127df2492
      InstanceType: !Ref InstanceType
      Tags:
        - Key: Name
          Value: !Ref InstanceName
  IamUser:
    Type: AWS::IAM::User
    Properties: 
      UserName: GautamSachdevaWatchguard

  IamPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: UserPolicy
      PolicyDocument: 
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Action: 
              - 's3:GetObject'
              - 's3:PutObject'
              - 's3:PutObjectAcl'
            Resource: !Sub 'arn:aws:s3:::${BucketName}'
      Users:
       - !Ref IamUser